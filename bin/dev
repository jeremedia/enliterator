#!/usr/bin/env sh

if ! gem list foreman -i --silent; then
  echo "Installing foreman..."
  gem install foreman
fi

# Enliterator runs on port 3077
export PORT="${PORT:-3077}"

# Enliterator domains
export RAILS_HOSTS="e.dev.domt.app,e.domt.app,localhost"
export DOMAIN_DEV="e.dev.domt.app"
export DOMAIN_PROD="e.domt.app"

# Let the debug gem allow remote connections,
# but avoid loading until `debugger` is called
export RUBY_DEBUG_OPEN="true"
export RUBY_DEBUG_LAZY="true"

echo "üöÄ Starting Enliterator on port $PORT"
echo "üìç Development: https://$DOMAIN_DEV"
echo "üìç Production: https://$DOMAIN_PROD (currently pointing to Mac)"
echo ""

exec foreman start -f Procfile.dev "$@"
